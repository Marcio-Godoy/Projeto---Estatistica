var tabelaDistNormal = [
[0.0000 , 0.0040 , 0.0080 , 0.0120 , 0.0160 , 0.0199 , 0.0239 , 0.0279 , 0.0319 , 0.0359],
[0.0398 , 0.0438 , 0.0478 , 0.0517 , 0.0557 , 0.0596 , 0.0636 , 0.0675 , 0.0714 , 0.0753],
[0.0793 , 0.0832 , 0.0871 , 0.0910 , 0.0948 , 0.0987 , 0.1026 , 0.1064 , 0.1103 , 0.1141],
[0.1179 , 0.1217 , 0.1255 , 0.1293 , 0.1331 , 0.1368 , 0.1406 , 0.1443 , 0.1480 , 0.1517],
[0.1554 , 0.1591 , 0.1628 , 0.1664 , 0.1700 , 0.1736 , 0.1772 , 0.1808 , 0.1844 , 0.1879],
[0.1915 , 0.1950 , 0.1985 , 0.2019 , 0.2054 , 0.2088 , 0.2123 , 0.2157 , 0.2190 , 0.2224],
[0.2257 , 0.2291 , 0.2324 , 0.2357 , 0.2389 , 0.2422 , 0.2454 , 0.2486 , 0.2517 , 0.2549],
[0.2580 , 0.2611 , 0.2642 , 0.2673 , 0.2704 , 0.2734 , 0.2764 , 0.2794 , 0.2823 , 0.2852],
[0.2881 , 0.2910 , 0.2939 , 0.2967 , 0.2995 , 0.3023 , 0.3051 , 0.3078 , 0.3106 , 0.3133],
[0.3159 , 0.3186 , 0.3212 , 0.3238 , 0.3264 , 0.3289 , 0.3315 , 0.3340 , 0.3365 , 0.3389],
[0.3413 , 0.3438 , 0.3461 , 0.3485 , 0.3508 , 0.3531 , 0.3554 , 0.3577 , 0.3599 , 0.3621],
[0.3643 , 0.3665 , 0.3686 , 0.3708 , 0.3729 , 0.3749 , 0.3770 , 0.3790 , 0.3810 , 0.3830],
[0.3849 , 0.3869 , 0.3888 , 0.3907 , 0.3925 , 0.3944 , 0.3962 , 0.3980 , 0.3997 , 0.4015],
[0.4032 , 0.4049 , 0.4066 , 0.4082 , 0.4099 , 0.4115 , 0.4131 , 0.4147 , 0.4162 , 0.4177],
[0.4192 , 0.4207 , 0.4222 , 0.4236 , 0.4251 , 0.4265 , 0.4279 , 0.4292 , 0.4306 , 0.4319],
[0.4332 , 0.4345 , 0.4357 , 0.4370 , 0.4382 , 0.4394 , 0.4406 , 0.4418 , 0.4429 , 0.4441],
[0.4452 , 0.4463 , 0.4474 , 0.4484 , 0.4495 , 0.4505 , 0.4515 , 0.4525 , 0.4535 , 0.4545],
[0.4554 , 0.4564 , 0.4573 , 0.4582 , 0.4591 , 0.4599 , 0.4608 , 0.4616 , 0.4625 , 0.4633],
[0.4641 , 0.4649 , 0.4656 , 0.4664 , 0.4671 , 0.4678 , 0.4686 , 0.4693 , 0.4699 , 0.4706],
[0.4713 , 0.4719 , 0.4726 , 0.4732 , 0.4738 , 0.4744 , 0.4750 , 0.4756 , 0.4761 , 0.4767],
[0.4772 , 0.4778 , 0.4783 , 0.4788 , 0.4793 , 0.4798 , 0.4803 , 0.4808 , 0.4812 , 0.4817],
[0.4821 , 0.4826 , 0.4830 , 0.4834 , 0.4838 , 0.4842 , 0.4846 , 0.4850 , 0.4854 , 0.4857],
[0.4861 , 0.4864 , 0.4868 , 0.4871 , 0.4875 , 0.4878 , 0.4881 , 0.4884 , 0.4887 , 0.4890],
[0.4893 , 0.4896 , 0.4898 , 0.4901 , 0.4904 , 0.4906 , 0.4909 , 0.4911 , 0.4913 , 0.4916],
[0.4918 , 0.4920 , 0.4922 , 0.4925 , 0.4927 , 0.4929 , 0.4931 , 0.4932 , 0.4934 , 0.4936],
[0.4938 , 0.4940 , 0.4941 , 0.4943 , 0.4945 , 0.4946 , 0.4948 , 0.4949 , 0.4951 , 0.4952],
[0.4953 , 0.4955 , 0.4956 , 0.4957 , 0.4959 , 0.4960 , 0.4961 , 0.4962 , 0.4963 , 0.4964],
[0.4965 , 0.4966 , 0.4967 , 0.4968 , 0.4969 , 0.4970 , 0.4971 , 0.4972 , 0.4973 , 0.4974],
[0.4974 , 0.4975 , 0.4976 , 0.4977 , 0.4977 , 0.4978 , 0.4979 , 0.4979 , 0.4980 , 0.4981],
[0.4981 , 0.4982 , 0.4982 , 0.4983 , 0.4984 , 0.4984 , 0.4985 , 0.4985 , 0.4986 , 0.4986],
[0.4987 , 0.4987 , 0.4987 , 0.4988 , 0.4988 , 0.4989 , 0.4989 , 0.4989 , 0.4990 , 0.4990],
[0.4990 , 0.4991 , 0.4991 , 0.4991 , 0.4992 , 0.4992 , 0.4992 , 0.4992 , 0.4993 , 0.4993],
[0.4993 , 0.4993 , 0.4994 , 0.4994 , 0.4994 , 0.4994 , 0.4994 , 0.4995 , 0.4995 , 0.4995],
[0.4995 , 0.4995 , 0.4995 , 0.4996 , 0.4996 , 0.4996 , 0.4996 , 0.4996 , 0.4996 , 0.4997],
[0.4997 , 0.4997 , 0.4997 , 0.4997 , 0.4997 , 0.4997 , 0.4997 , 0.4997 , 0.4997 , 0.4998],
[0.4998 , 0.4998 , 0.4998 , 0.4998 , 0.4998 , 0.4998 , 0.4998 , 0.4998 , 0.4998 , 0.4998],
[0.4998 , 0.4998 , 0.4999 , 0.4999 , 0.4999 , 0.4999 , 0.4999 , 0.4999 , 0.4999 , 0.4999],
[0.4999 , 0.4999 , 0.4999 , 0.4999 , 0.4999 , 0.4999 , 0.4999 , 0.4999 , 0.4999 , 0.4999],
[0.4999 , 0.4999 , 0.4999 , 0.4999 , 0.4999 , 0.4999 , 0.4999 , 0.4999 , 0.4999 , 0.4999],
[0.5000 , 0.5000 , 0.5000 , 0.5000 , 0.5000 , 0.5000 , 0.5000 , 0.5000 , 0.5000 , 0.5000],
];

function buscarZ( p ){
	var p = p / 2;
	var z;
	
	for( i = 0; i < tabelaDistNormal.length; i++ ){
		linha = tabelaDistNormal[i];
		for( j = 0; j < linha.length; j++ ){
			
			if( p >= parseFloat(linha[j]) ){
				z = i / 10 + j / 100;
			}else{
				break;
			}
		}
	}
	return z;
}

function buscarP( z ){
	z *= 10;
	i = parseInt(z / 1);
	j = Math.round((z % 1) * 10);
	
	p = tabelaDistNormal[i][j];
	
	return p;
}

//Inicio das funções referentes a distribuição normal
function calcularDN(){
	media = parseFloat(document.getElementById("mediaDN").value);
	desvPadrao = parseFloat(document.getElementById("desviopadraoDN").value);
	intervalo = document.getElementById("interDN").value.split(";");

	inter1 = parseFloat(intervalo[0]);
	inter2 = parseFloat(intervalo[1]);
	
	if(inter1 == inter2){
		if(media == inter1){
			p = 0.50;
		}else{
			z = Math.abs((inter1  - media)/desvPadrao);
			p = 0.5 - buscarP(z);
		}
	}else{
		if((media > inter1 && media > inter2) || (media < inter1 && media < inter2)){
			z1 = Math.abs((inter1  - media)/desvPadrao);
			z2 = Math.abs((inter2  - media)/desvPadrao);
			p = Math.abs(buscarP(z1) - buscarP(z2));
		}else if((media < inter1 && media > inter2)||(media > inter1 && media < inter2)){
			z1 = Math.abs((inter1  - media)/desvPadrao);
			z2 = Math.abs((inter2  - media)/desvPadrao);
			p =  Math.abs(buscarP(z1) + buscarP(z2));
		}else{
			z1 = Math.abs((inter1  - media)/desvPadrao);
			z2 = Math.abs((inter2  - media)/desvPadrao);
			p = Math.abs(buscarP(z1) - buscarP(z2));
		}
	}
	
	document.getElementById("probDN").innerHTML = (p * 100).toFixed(2) +" %";
}


function mostrarIntervalo(){
	media = parseFloat(document.getElementById("mediaDN").value);
	intervalo = document.getElementById("intervaloDN")
	intervalo.innerHTML = "<input type='text' id='interDN' value='' name='interDN' />";
$(function () {
    $("#interDN").ionRangeSlider({
        hide_min_max: true,
        keyboard: true,
        min: media / 2,
        max: media*3/2,
        from: media,
        to: media,
        type: 'double',
        step: 1,
        prefix: "",
        grid: true
    });

});

}
//Fim das funções referentes a distribuição normal.

//Início das funções referentes ao intervalo de confiança.
var finita = false;

function tipoPop(){
   var radios = document.getElementsByName("tipoPopulacao");

  for(i in radios){
    if(radios[i].checked){
      if(radios[i].value == "popInfinita"){
		document.getElementById("tamPop").innerHTML = "Tamanho da População: <input type='number' step='1' min='0' name='tamPopIC' id='tamPopIC' disabled='disabled' />";
		finita = false;
      }else if(radios[i].value == "popFinita"){
        document.getElementById("tamPop").innerHTML = "Tamanho da População: <input type='number' step='1' min='0' name='tamPopIC' id='tamPopIC' />";
		finita = true;
	  }
      break;
    }
  }
}

function calcIntConfianca(){
	tamAmostra = parseFloat(document.getElementById("tAmostraIC").value);
	media = parseFloat(document.getElementById("mediaIC").value);
	coefConfianca = document.getElementById("coefConfIC").value / 100;
	varianca = parseFloat(document.getElementById("variancafIC").value);
	z = buscarZ( coefConfianca );
	
	if(finita == true){
		populacao = document.getElementById("tamPopIC").value;
		erroPadrao = z *  Math.sqrt( varianca ) / Math.sqrt( tamAmostra ) * Math.sqrt((populacao - tamAmostra)/(populacao - 1));
	}else{
		erroPadrao =  z * Math.sqrt( varianca ) / Math.sqrt( tamAmostra );
	}

	document.getElementById("interConf").innerHTML = ( media - erroPadrao ).toFixed(2) + " |-------------| " + ( media + erroPadrao ).toFixed(2);
}


//Fim das funções referentes ao intervalo de confiança.

//Início das Funções referentes à distribuição binomial
function mostrarEvento(){
	evento = document.getElementById("evento")
	evento.innerHTML = "<input type='text' id='range' value='' name='range' />";
	
	n = document.getElementById("tAmostra").value;
	
	if(n <= 0)
		alert("A amostra não pode ser Zero ou negativo!!!");

$(function () {
    $("#range").ionRangeSlider({
        hide_min_max: true,
        keyboard: true,
        min: 0,
        max: n,
        from: n/4,
        to: n/2,
        type: 'double',
        step: 1,
        prefix: "",
        grid: true
    });

});
}

function calcBinomial(){
	var amostra = document.getElementById("tAmostra").value / 1 ;
	var sucesso = document.getElementById("sucesso").value / 100;
	var fracasso = document.getElementById("fracasso").value / 100;
	var evento = document.getElementById("range").value.split(";");
	var probTotal = 0;
	
	var k1 = parseInt(evento[0]);
	var k2 = parseInt(evento[1]);
	
	if( k1 == k2){
		probTotal = analiseCombinatoria(amostra, k1) * (sucesso ** k1) * (fracasso ** (amostra - k1));
	}else{
		for( k1; k1 <= k2; k1++){
			probabilidade = analiseCombinatoria(amostra, k1) * (sucesso ** k1) * (fracasso ** (amostra - k1));
			probTotal += probabilidade;
		}
		
	}
	
	media = sucesso * amostra;
	desPadrao = Math.sqrt(amostra * fracasso * sucesso)
	coefVarianca = (desPadrao / media) * 100
	probTotal *= 100;
	
	exibirDadosBin( probTotal.toFixed(2), media.toFixed(2), desPadrao.toFixed(2), coefVarianca.toFixed(2) );
}

function exibirDadosBin(p, x, dp, cv){
	document.getElementById("probabilidade").innerHTML = p + "%";
	document.getElementById("media").innerHTML = x ;
	document.getElementById("desvioPadrao").innerHTML = dp ; 
	document.getElementById("coefVarianca").innerHTML = cv + "%" ;
}

function fatorial( f ){
	if( f == 1 )
		return 1;
	else
		return f * fatorial( f - 1 );
}

function analiseCombinatoria( n , k ){
	if(k == 0)
		return 1;
	else if( k == 1)
		return n;
	else if( k == n )
		return 1;
	else
		return fatorial(n) / ( fatorial(k) * fatorial(n-k));
}
//Fim das Funções referentes à distribuição binomial

//Inicio das funções referentes à correlação e regressão.
function calcCorrelacao(){
	indep = document.getElementById("independente").value.split(",");
	depen = document.getElementById("dependente").value.split(",");
	
	n = indep.length;
	somxifi = somXiFi(indep,depen);
	somxi = somXi(indep);
	somyi = somYi(depen);
	somxiQuad = somXiQuadrado(indep);
	somyiQuad = somYiQuadrado(depen);
	
	coefCorr = ( n * somxifi - somxi * somyi )/ Math.sqrt( ( n * somxiQuad - somxi * somxi ) * ( n * somyiQuad - somyi * somyi ) );
	a = (n * somxifi - somxi * somyi) / (n * somxiQuad - somxi * somxi );
	b =  somyi / n - a * somxi/n;
	
	mostraValores(coefCorr);
	regress = document.getElementById("regressao");
	regress.innerHTML = "Y = "+ a.toFixed(2) + "x " + "+" +(b).toFixed(2);
	
	grafico(a,b,indep,n,depen)
}

function grafico(a,b,xi,n,yi){
	xi.sort((j,k) => j - k);
	var x = [];
	var y = [];
	for( i = 0; i <= xi[n-1]; i++ ){
		x.push(i);
		y.push( a * i + b);
	}
	
	var ctx = document.getElementsByClassName("lineChart");
	var chartGraph = new Chart(ctx,{
			type: "line",
			data:{
				labels:x,
				datasets:[{
					label: "Reta",
					data:y,
					borderWidth: 2,
					borderColor: "rgba(77,166,253,0.85)",
					backgroundColor: "transparent",
				}],

			},
	});
}
//Fim do gráfico

function somXiFi(x,y){
	som = 0;
	for(i = 0; i < x.length; i++){
		som += x[i]*y[i];
	}
	return(som);
}

function somXi(x){
	som = 0;
	
	for(i = 0; i < x.length; i++){
		som += x[i]*1;
	}
	return(som);
}
function somXiQuadrado(x){
	som = 0;
	
	for(i = 0; i < x.length; i++){
		som += x[i]*x[i];
	}
	return(som);
}
function somYi(y){
	som = 0;
	
	for(i = 0; i < y.length; i++){
		som += y[i]*1;
	}
	return(som);
}
function somYiQuadrado(y){
	som = 0;
	
	for(i = 0; i < y.length; i++){
		som += y[i]*y[i];
	}
	return(som);
}

function mostraValores(c){
	cAbs = Math.abs(c);
	
	if(cAbs == 0)
		resul = "Não há correlação";
	else if(cAbs < 0.3)
		resul = "Inexiste ou muito fraca";
	else if(cAbs < 0.6)
		resul = "Muito fraca ou média";
	else 
		resul = "Média ou forte";
	
	local = document.getElementById("correLinear");
	
	if(c == 1){
		local.innerHTML = (c * 100).toFixed(2) + "% --- Perfeita e positiva";
	}else if( c == -1){
		local.innerHTML = (c * 100).toFixed(2) + "% --- Perfeita e negativa";
	}else if(cAbs == 0){
		local.innerHTML = (c * 100).toFixed(2) + "% --- Não há correlação";
	}else{
		local.innerHTML = (c * 100).toFixed(2) + "% ---" + resul;
	}
}
//Fim das funções referentes à correlação e regressão.
